setwd("C:/Users/cflagg/Documents/GitHub/codingSupportGroup/FSUTools/multi_worksheet_ex.xlsx")
setwd("C:/Users/cflagg/Documents/GitHub/codingSupportGroup/FSUTools/")
getwd()
list.files()
f <- ("C:/Users/cflagg/Documents/GitHub/codingSupportGroup/FSUTools/multi_worksheet_ex.xlsx")
f
library(XLConnect)
library(plyr)
? readWorksheet
# create a function to pull all of the worksheets together into a single data frame
multiWorksheetCombine_xls <- function(input){
# loading excel workbook
#output <- data.frame()
#browser()
# create an empty object to fill
output <- NULL
t <- loadWorkbook(input)
# variable to pass sheet names
sheets_list <- getSheets(t)
# iterate through every sheet, load workbook 't' and worksheet 's'
for (sh in unique(sheets_list)){
w <- readWorksheet(t, sheet = sh, header = TRUE)
# fix herbaceous clip column names
# add the date
# print(head(t2))
# append the names from the worksheet to the data.frame
output <- rbind.fill(w, output)
}
return(output)
}
multiWorksheetCombine_xls(f)
